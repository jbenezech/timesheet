<template>

    <div class="admin reports ui container fluid">

        <h2>${month}</h2>
        <div class="right aligned ui segment">
            <a id="csv-export-link" t="download">Download</a>
        </div>

        <div class="ui grid basic segment">
            <div 
                class="ui toggle checkbox"
                id="showMonthAggregate"
            >
                <input
                    type="checkbox"
                    name="monthaggregate"
                >
                <label t="report:showmonthaggregate">Show month aggregate</label>
            </div>
        </div>

        <div 
            class="user report"
            if.bind="!showMonthAggregate"
            repeat.for="[userName, userReport] of allocationUserReports"
        >
            <h3>${ userName }</h3>
            <div class="right aligned ui segment">
                <a 
                    id="${userName}-csv-export-link"
                    t="download"
                    data-user="${userName}"
                >
                    Download
                </a>
            </div>

            <table class="ui celled table">
                <thead>
                    <tr>
                        <th t="allocation">Allocation</th>
                        <th t="ratio">Ratio</th>
                        <th t="duration">Duration</th>
                        <th t="salary">Salary</th>
                    </tr>
                </thead>
                <tbody>
                    <tr repeat.for="report of userReport.entries">
                        <td>${report.allocationName}</td>
                        <td>${report.ratio.toFixed(2)}%</td>
                        <td>${report.duration.toFixed(2)}h</td>
                        <td>${report.salary.toFixed(2)}$</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th t="total"></th>
                        <th>${ userReport.totals.ratio.toFixed(2) }%</th>
                        <th>${ userReport.totals.duration.toFixed(2) }h</th>
                        <th>${ userReport.totals.salary.toFixed(2) }$</th>
                    </tr>
                </tfoot>
            </table>
        </div>

        <table
            if.bind="showMonthAggregate" 
            class="ui celled table"
        >
            <thead>
                <tr>
                    <th t="allocation">Allocation</th>
                    <th t="ratio">Ratio</th>
                    <th t="duration">Duration</th>
                    <th t="salary">Salary</th>
                </tr>
            </thead>
            <tbody>
                <tr repeat.for="report of allocationReports.entries">
                    <td>${report.allocationName}</td>
                    <td>${report.ratio.toFixed(2)}%</td>
                    <td>${report.duration.toFixed(2)}h</td>
                    <td>${report.salary.toFixed(2)}$</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <th t="total"></th>
                    <th>${ allocationReports.totals.ratio.toFixed(2) }%</th>
                    <th>${ allocationReports.totals.duration.toFixed(2) }h</th>
                    <th>${ allocationReports.totals.salary.toFixed(2) }$</th>
            </tfoot>
        </table>

    </div>

</template>